<div class="kanban-board">
    <div *ngFor="let status of taskStatusList" class="kanban-column">
        <div class="column-header">
            <h3>{{ status }}</h3>
            <span class="task-count">{{ (tasksByStatus$ | async)?.[status]?.length || 0 }}</span>
        </div>
        <div
            class="task-list"
            cdkDropList
            [cdkDropListData]="(tasksByStatus$ | async)?.[status] || []"
            (cdkDropListDropped)="onTaskDrop($event)">
            
            <div
                *ngFor="let task of (tasksByStatus$ | async)?.[status]"
                class="task-card"
                cdkDrag>
                <div class="task-header">
                    <span class="task-title">{{ task.title }}</span>
                    <span class="task-priority {{ task.priority.toLowerCase() }}">
                        {{ task.priority }}
                    </span>
                </div>
                <p class="task-description">{{ task.description }}</p>
                <div class="task-footer">
                    <div class="assignee" *ngIf="task.assignee">
                        <img [src]="task.assignee.avatarUrl || 'assets/default-avatar.png'"
                             [attr.alt]="task.assignee && task.assignee.name ? 'Avatar of ' + task.assignee.name : 'Default avatar'"
                             [title]="'Assigned to ' + (task.assignee.name || 'Unassigned')"
                             class="assignee-avatar">
                        <span>{{ task.assignee.name }}</span>
                    </div>
                    <div class="task-due-date" *ngIf="task.dueDate">
                        {{ task.dueDate | date:'shortDate' }}
                    </div>
                </div>
                <div class="task-tags" *ngIf="task.tags?.length">
                    <span class="tag" *ngFor="let tag of task.tags">
                        {{ tag }}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>